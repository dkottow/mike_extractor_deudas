import pytest
from lambda_function import lambda_handler


def text_textract_with_cav():
    event = {
        "version": "1.0",
        "timestamp": "2021-01-20T22:00:58.720Z",
        "requestContext": {
            "requestId": "3d6dbba0-ed17-48cc-ab81-1a1ecf0c298b",
            "functionArn": "arn:aws:lambda:us-east-2:454177333545:function:Mike_OCR_PDF_To_Descriptor:$LATEST",
            "condition": "Success",
            "approximateInvokeCount": 1,
        },
        "requestPayload": {
            "Records": [
                {
                    "eventVersion": "2.1",
                    "eventSource": "aws:s3",
                    "awsRegion": "us-east-2",
                    "eventTime": "2021-01-20T22:00:50.452Z",
                    "eventName": "ObjectCreated:Put",
                    "userIdentity": {"principalId": "AWS:AROAWTPYUEEUQM3LJFI6F:Mike_OCR_Map"},
                    "requestParameters": {"sourceIPAddress": "3.140.199.2"},
                    "responseElements": {
                        "x-amz-request-id": "01BDDA64A6566AB6",
                        "x-amz-id-2": "rn+rY2kH6sJb4VuIpiBqsaNb/pezRnzTGwekX2ZzEy5ydryeQV9tQd1xwFRBf88PFMvZXwR1DpJCmHrK2y6yBR4ETGTO/P35",
                    },
                    "s3": {
                        "s3SchemaVersion": "1.0",
                        "configurationId": "4cdd5e97-9790-4cb6-bb9c-fa4648ad18cf",
                        "bucket": {
                            "name": "textract-console-us-east-2-7e1edcda-ec50-4013-9762-a06e7b200006",
                            "ownerIdentity": {"principalId": "AFTBJ9N16F5MT"},
                            "arn": "arn:aws:s3:::textract-console-us-east-2-7e1edcda-ec50-4013-9762-a06e7b200006",
                        },
                        "object": {
                            "key": "ExtractorDeudas/Archivo/Forum/2021-01-20T22_00_52_875730/CAMILA_SEGUEL_-_CAV.pdf",
                            "size": 47395,
                            "eTag": "3cc458c4c5ba498b93005268ef061cac",
                            "sequencer": "006008A8174A4310A0",
                        },
                    },
                }
            ]
        },
        "responseContext": {"statusCode": 200, "executedVersion": "$LATEST"},
        "responsePayload": {
            "key": "ExtractorDeudas/Archivo/Forum/Test/CAMILA_SEGUEL_-_CAV.pdf",
            "document_type": "cav",
        },
    }

    expected_output = {
        "document_type": "cav",
        "key": "ExtractorDeudas/Archivo/Forum/Test/CAMILA_SEGUEL_-_CAV.pdf",
        "forms": {},
        "tables": [],
        "text": "SERVICIO DE REGISTRO FOLIO : 500290785328 CIVIL E IDENTIFICACION Código Verificación: 9f82349a2af7 REPUBLICA DE CHILE 500290785328 CERTIFICADO DE INSCRIPCION Y ANOTACIONES VIGENTES EN EL R. V. M. Inscripción : GPGX. 10- DATOS DEL VEHICULO Tipo Vehículo : AUTOMOVIL Año : 2013 Marca : AUDI Modelo : A1 SPORTBACK ATTRACTION 1.4 AUT Nro. Motor : CAX D59884 Nro. Chasis : WAUZZZ8X7DB118623 Color : PLATEADO HIELO Combustible : GASOLINA PBV : 1.290,00 KILOS Instit. aseg. : ROYAL & SUN ALLIANCE SEGUROS S.A. Numero poliza : 7.562.025 Fec. ven. pol. : 31-03-2020 DATOS DEL PROPIETARIO Nombre : CAMILA CONSTANZA SEGUEL OLIVARES R.U.N. : 17.028.624-3 Fec. adquisición: 05-04-2018 Repertorio : ALAMEDA Número : 205965 de fecha : 06-04-2018 Sr. usuario: Corrobore la exactitud de los datos identificatorios del vehiculo FECHA EMISIÓN: 23 Enero 2020, 17:28. Continúa en la página 2 Verifique documento en www.registrocivil.gob.cl o a nuestro Call Center 600 370 2000, para teléfonos fijos y celulares. La próxima vez, obtén este certificado en www.registrocivil.gob.cl. GOBINDGARH * * Timbre electrónico SRCel 8530233 www.registrocivil.gob.c SERVICIO DE REGISTRO FOLIO : 500290785328 CIVIL E IDENTIFICACION Código Verificación: 9f82349a2af7 REPUBLICA DE CHILE 500290785328 CERTIFICADO DE INSCRIPCION Y ANOTACIONES VIGENTES EN EL R. V. M. Página 2 Inscripción : GPGX.: 10- LIMITACIONES AL DOMINIO PRENDA Tipo Documento : ESCRITURA PUBLICA Naturaleza acto : PRENDA Nro. Doc. o Rol : 125579-2018 Lugar : SANTIAGO Fecha : 13-04-2018 - Autorizante : FRANCISCO LEIVA CARVAJAL Acreedor : FORUM SERVICIOS FINANCIEROS S.A. Repertorio : UNIDAD DE PRENDAS SIN DESPLAZAMIENTO Número : 141539 de fecha : 13-04-2018 PROHIBICION DE ENAJENAR Tipo Documento : ESCRITURA PUBLICA Naturaleza acto : PROHIB ACTOS Nro. Doc. o Rol : 125579-2018 Lugar : SANTIAGO Fecha : 13-04-2018 Autorizante : FRANCISCO LEIVA CARVAJAL Sr. usuario: Corrobore la exactitud de los datos identificatorios del vehiculo FECHA EMISIÓN: 23 Enero 2020, 17:28. Continúa en la página 3 Verifique documento en www.registrocivil.gob.cl o a nuestro Call Center 600 370 2000, para teléfonos fijos y celulares. La próxima vez, obtén este certificado en www.registrocivil.gob.cl. GOBINDGARH * * Timbre electrónico SRCel 8530233 www.registrocivil.gob.c SERVICIO DE REGISTRO FOLIO : 500290785328 CIVIL E IDENTIFICACION Código Verificación: 9f82349a2af7 REPUBLICA DE CHILE 500290785328 CERTIFICADO DE INSCRIPCION Y ANOTACIONES VIGENTES EN EL R. V. M. Página 3 Inscripción : GPGX. 10- 8 Acreedor : FORUM SERVICIOS FINANCIEROS S.A. Repertorio : UNIDAD DE PRENDAS SIN DESPLAZAMIENTO Número : 141540 de fecha : 13-04-2018 DATOS DE PROPIETARIOS ANTERIORES Nombre : PORSCHE INTER AUTO CHILE SPA R.U.T. : 76.178.493-5 Repertorio : LO BARNECHEA Número : 17412 de fecha : 25-06-2014 Nombre : JUAN ANDREI ROJAS VILLAR R.U.N. : 12.637.825-4 Repertorio : VITACURA Número : 3408 de fecha : 29-01-2015 Nombre : COMERCIAL AUTOMOTRIZ SIGLO XXI LTDA R.U.T. : 78.770.630-4 Repertorio : ALAMEDA Número : 637188 de fecha : 19-12-2017 Sr. usuario: Corrobore la exactitud de los datos identificatorios del vehiculo FECHA EMISIÓN: 23 Enero 2020, 17:28. Valor Pagado Impreso en : REGION : Verifique documento en www.registrocivil.gob.cl o a nuestro Call Center 600 370 2000, para teléfonos fijos y celulares. La próxima vez, obtén este certificado en www.registrocivil.gob.cl. GOBINDGARH * Gevel Víctor Rebolledo Salas Jefe de Archivo General (s) Timbre electrónico SRCel Incorpora Firma Electrónica Avanzada www.registrocivil.gob.ci ",
    }
    results = lambda_handler(event, "")
    assert results == expected_output


def text_textract_with_pagare():
    event = {
        "version": "1.0",
        "timestamp": "2021-01-20T22:00:58.720Z",
        "requestContext": {
            "requestId": "3d6dbba0-ed17-48cc-ab81-1a1ecf0c298b",
            "functionArn": "arn:aws:lambda:us-east-2:454177333545:function:Mike_OCR_PDF_To_Descriptor:$LATEST",
            "condition": "Success",
            "approximateInvokeCount": 1,
        },
        "requestPayload": {
            "Records": [
                {
                    "eventVersion": "2.1",
                    "eventSource": "aws:s3",
                    "awsRegion": "us-east-2",
                    "eventTime": "2021-01-20T22:00:50.452Z",
                    "eventName": "ObjectCreated:Put",
                    "userIdentity": {"principalId": "AWS:AROAWTPYUEEUQM3LJFI6F:Mike_OCR_Map"},
                    "requestParameters": {"sourceIPAddress": "3.140.199.2"},
                    "responseElements": {
                        "x-amz-request-id": "01BDDA64A6566AB6",
                        "x-amz-id-2": "rn+rY2kH6sJb4VuIpiBqsaNb/pezRnzTGwekX2ZzEy5ydryeQV9tQd1xwFRBf88PFMvZXwR1DpJCmHrK2y6yBR4ETGTO/P35",
                    },
                    "s3": {
                        "s3SchemaVersion": "1.0",
                        "configurationId": "4cdd5e97-9790-4cb6-bb9c-fa4648ad18cf",
                        "bucket": {
                            "name": "textract-console-us-east-2-7e1edcda-ec50-4013-9762-a06e7b200006",
                            "ownerIdentity": {"principalId": "AFTBJ9N16F5MT"},
                            "arn": "arn:aws:s3:::textract-console-us-east-2-7e1edcda-ec50-4013-9762-a06e7b200006",
                        },
                        "object": {
                            "key": "ExtractorDeudas/Archivo/Forum/2021-01-20T22_00_52_875730/CAMILA_SEGUEL_-_CAV.pdf",
                            "size": 47395,
                            "eTag": "3cc458c4c5ba498b93005268ef061cac",
                            "sequencer": "006008A8174A4310A0",
                        },
                    },
                }
            ]
        },
        "responseContext": {"statusCode": 200, "executedVersion": "$LATEST"},
        "responsePayload": {
            "key": "ExtractorDeudas/Archivo/Forum/Test/CAMILA_SEGUEL_-_PAGARE.pdf",
            "document_type": "pagare",
        },
    }

    expected_output = {
        "document_type": "pagare",
        "key": "ExtractorDeudas/Archivo/Forum/Test/CAMILA_SEGUEL_-_PAGARE.pdf",
        "forms": {},
        "tables": [],
        "text": 'FORUM PAGARÉ FORUM SERVICIOS FINANCIEROS S.A. RUT: 96.678.790-2 Giro: financiera, leasing, compra, venta, no 1150427 y arriendo de bienes, factoring, En pesos - sin obligaciones de protesto Serv. de Adm. de cartera y comisión de seguros, Drllo. y Lie. de software. DEBO Y PAGARÉ A LA ORDEN DE FORUM SERVICIOS FINANCIEROS S.A., LA SUMA DE $7.839.317 (SIETE MILLONES OCHOCIENTOS TREINTA Y NUEVE MIL TRESCIENTOS DIECISIETE PESOS), VALOR QUE ME OBLIGO A PAGAR EN 36 CUOTAS, INCLUIDO EL INTERÉS DE 1,79% CADA 30 DÍAS, CON VENCIMIENTO LA PRIMERA DE ELLAS EL DÍA 10 DE MAYO DE 2018 Y LAS RESTANTES LOS DÍAS 10 DE LOS MESES SIGUIENTES. N# FECHA MONTO N# FECHA MONTO N# FECHA MONTO N# FECHA MONTO 1 10/05/2018 301.072 19 10/11/2019 301.072 2 10/06/2018 301.072 20 10/12/2019 301.072 3 10/07/2018 301.072 21 10/01/2020 301.072 4 10/08/2018 301.072 22 10/02/2020 301.072 5 10/09/2018 301.072 23 10/03/2020 301.072 6 10/10/2018 301.072 24 10/04/2020 301.072 7 10/11/2018 301.072 25 10/05/2020 301.072 8 10/12/2018 301.072 26 10/06/2020 301.072 9 10/01/2019 301.072 27 10/07/2020 301.072 10 10/02/2019 301.072 28 10/08/2020 301.072 11 10/03/2019 301.072 29 10/09/2020 301.072 12 10/04/2019 301.072 30 10/10/2020 301.072 13 10/05/2019 301.072 31 10/11/2020 301.072 14 10/06/2019 301.072 32 10/12/2020 301.072 15 10/07/2019 301.072 33 10/01/2021 301.072 16 10/08/2019 301.072 34 10/02/2021 301.072 17 10/09/2019 301.072 35 10/03/2021 301.072 18 10/10/2019 301.072 36 10/04/2021 301.072 LOS INTERESES QUE NO SE PAGUEN EN SUS RESPECTIVOS VENCIMIENTOS, SE CAPITALIZARÁN, SIN PERJUICIO DE LA FACULTAD DE EXIGIR DE INMEDIATO EL TOTAL DE LA OBLIGACIÓN QUE ESTUVIERE PENDIENTE. LA FALTA DE PAGO DE CUALQUIERA DE LAS CUOTAS ANTES SEÑALADAS, O DE SUS REAJUSTES O INTERESES, DARÀ DERECHO AL ACREEDOR PARA EXIGIR LA TOTALIDAD DE LO ADEUDADO Y SUS REAJUSTES E INTERESES INDICADOS, CONSIDERANDOSE IPSOFACTO LA OBLIGACIÓN COMO DE PLAZO VENCIDO, PUDIENDO COBRAR EL ACREEDOR LA TOTALIDAD DE LA DEUDA, SALVO EN CASO DE TENER LA CALIDAD DE DEUDOR EN UN PROCEDIMIENTO CONCURSAL DE REORGANIZACIÓN O RENEGOCIACIÓN. SIN PERJUICIO DE LO ANTERIOR, EN LAS OPERACIONES DE CRÉDITO POR MONTOS INFERIORES A UF200, SÓLO PODRA HACERSE EXIGIBLE LA OBLIGACIÓN ANTICIPADAMENTE, UNA VEZ CUMPLIDOS 60 DÍAS DESDE LA FECHA DE LA MORA O SIMPLE RETARDO. EL PAGO DE LO ADEUDADO, SE HARÁ EN LA OFICINA DEL CENTRO DE FINANCIAMIENTO Y RECAUDACIÓN DE FORUM SERVICIOS FINANCIEROS S.A., ANTES DE LAS 18.00 HORAS DEL DÍA DE SU VENCIMIENTO. EN CASO DE MORA O SIMPLE RETARDO EN EL PAGO DE LA(S) CUOTA(S) Y DE LOS INTERESES QUE CORRESPONDEN, DARÁ LUGAR A QUE SE DEVENGUE POR LA MORA O RETARDO EL INTERÉS MÁXIMO CONVENCIONAL PARA OPERACIONES DE CRÉDITO EN DINERO EN MONEDA NACIONAL, QUE LA LEY PERMITE ESTIPULAR, HASTA LA FECHA DEL PAGO EFECTIVO, SALVO EN CASO DE APLICACIÓN DEL ARTÍCULO 264 N° 3 DE LA LEY 20.720 EL SUSCRIPTOR AUTORIZA EXPRESAMENTE A FORUM SERVICIOS FINANCIEROS S.A., PARA INFORMAR, TRATAR Y/O COMUNICAR A CUALQUIER BASE DE DATOS SUS ANTECEDENTES PERSONALES CONSIGNADOS EN EL PRESENTE INSTRUMENTO, ASÍ COMO EL INCUMPLIMIENTO, SIMPLE RETARDO O MORA EN QUE INCURRA EL SUSCRIPTOR RESPECTO DE LAS OBLIGACIONES QUE PARA ÉL EMANAN DEL PRESENTE PAGARÉ. LIBERO AL ACREEDOR DE LA OBLIGACIÓN DE PROTESTO, PERO SI ÉSTE OPTARA POR EFECTUARLO, ME OBLIGO A PAGAR LOS GASTOS E IMPUESTOS QUE DICHA DILIGENCIA DEVENGUE. DECLARO QUE ESTA OBLIGACIÓN LA CONTRAIGO EN EL CARÁCTER DE INDIVISIBLE, DE MANERA QUE EN CONFORMIDAD A LO DISPUESTO EN EL ARTÍCULO 1528 DEL CÓDIGO CIVIL, SU CUMPLIMIENTO PODRÀ EXIGIRSE A CUALQUIERA DE MIS HEREDEROS. EN EL EVENTO QUE EL DEUDOR DESEE ANTICIPAR EL PAGO DEL PRESENTE PAGARÉ, LA COMISIÓN DE PREPAGO CORRESPONDERÁ A 1 MES DE INTERESES, CALCULADOS SOBRE EL CAPITAL QUE SE PREPAGA. PARA TODOS LOS EFECTOS LEGALES, JUDICIALES Y DE EVENTUAL PROTESTO DE ESTE DOCUMENTO, EL SUSCRIPTOR FIJA SU DOMICILIO EN SANTIAGO, REGIÓN METROPOLITANA Y SE SOMETE A LA COMPETENCIA DE SUS TRIBUNALES ORDINARIOS DE JUSTICIA, O A LOS COMPETENTES A SU DOMICILIO, A ELECCIÓN DE FORUM SERVICIOS FINANCIEROS S. A. . Casa Matriz: Isidora Goyenechea 3365. Piso 3. 4. 5 y 8 Las Condes. Santiago. Centro de Financiamlento y Recaudación: Isidora Goyenechea 3477, Block: NIV -1. Dep/Loc 10, ZOCALO. Las Condes, Santiago-Sucursales Autoplaza en Malí Plaza: Av. Vicuña Mackenna Ote. Nro: 7110. Dep/Loc: AP108, La Florida, Santiago Américo Vespucio. Nro: 1737 Dep/Loc AP115. Huechuraba, Santiago. Av. Jorge Alessandrl, Nro: 3177, Talcahuano, Concepción. Av. Balmaceda, Nro: 2355, Dep/Loc: AP-09, Antofagasta Américo Vespucio, Nro: 1501, Dep/Loc: 152, Cerrillos. Santiago Camilo Henrfquez, Nro: 3296, Dep/Loc 109B. Puente Alto, Santiago, Av. Larrain, Nro: 5862, Dep/Loc AP 1.100, La Reina. Santiago. Av. Jorge Alessandrl, Nro: 20040, Dep/Loc: AP111 San Bernardo, Santiago Unidad de Vehículos Recuperados: Av. Claudio Arrau Nro: 6810, Pudahuel, Santiago, -Sucursal Movicenter: Américo Vespucio Norte, Nro: 1155, Dep/Loc H23. Huechuraba, Santiago. Oficina Ciudad Empresarial: Av. Del Valle 787, piso 6. Oficina 602 mEdificio 14". Ciudad empresarial, Huechuraba. Santiago. DEUDOR NOMBRE O RAZÓN SOCIAL: CAMILA CONSTANZA SEGUEL OLIVARES RUT: 17.028.624-3 DOMICILIADO EN CALLE: YERBAS BUENAS 27 DPTO 76 COMUNA: LOS ANDES CIUDAD: LOS ANDES SANTIAGO, 27 DE MARZO DE 2018. FIRMA DEL SUSCRIPTOR CLAUSULA AVAL EL (LOS) ABAJO SUSCRITO(S) ME (NOS) CONSTITUYO (CONSTITUIMOS) EN AVAL (ES), FIADOR(ES) Y CODEUDOR(ES) SOLIDARIO(S) DEL DEUDOR PRINCIPAL ANTES INDIVIDUALIZADO, PARA EL PAGO DE TODAS LAS OBLIGACIONES CONTENIDAS Y A LAS QUE HACE REFERENCIA EL PAGARÉ PRECEDENTE. EL SUSCRITO AUTORIZA EXPRESAMENTE A FORUM SERVICIOS FINANCIEROS S.A., PARA INFORMAR, TRATAR Y/O COMUNICAR A CUALQUIER BASE DE DATOS MIS ANTECEDENTES PERSONALES CONSIGNADOS EN EL PRESENTE INSTRUMENTO, ASÍ COMO EL INCUMPLIMIENTO, SIMPLE RETARDO O MORA EN QUE INCURRA EL DEUDOR RESPECTO DE LAS OBLIGACIONES QUE PARA ÉL EMANAN DEL PRESENTE PAGARÉ. NOMBRE O RAZÓN SOCIAL: RUT: DOMICILIADO EN CALLE: COMUNA: CIUDAD: SANTIAGO, DE DE . FIRMA DEL AVAL.FIADOR Y/O CODEUDOR SOLIDARIO AUTORIZO LA FIRMA DE DON (A) CAMILA CONTANZA SEGUEL OLIVARES, CNI. 17.028.624-3, COMO DEUDOR. QUIEN FIRMO EN LA FECHA DE SU EMISION Y ACREDITA IDENTIDAD CON LA CEDULA RESPECTIVA.- SANTIAGO 03 ABRIL 2018.- V. 2 PG001150427 nocumenro ',
    }
    results = lambda_handler(event, "")
    assert results == expected_output


def text_textract_with_tabla():
    event = {
        "version": "1.0",
        "timestamp": "2021-01-20T22:00:58.720Z",
        "requestContext": {
            "requestId": "3d6dbba0-ed17-48cc-ab81-1a1ecf0c298b",
            "functionArn": "arn:aws:lambda:us-east-2:454177333545:function:Mike_OCR_PDF_To_Descriptor:$LATEST",
            "condition": "Success",
            "approximateInvokeCount": 1,
        },
        "requestPayload": {
            "Records": [
                {
                    "eventVersion": "2.1",
                    "eventSource": "aws:s3",
                    "awsRegion": "us-east-2",
                    "eventTime": "2021-01-20T22:00:50.452Z",
                    "eventName": "ObjectCreated:Put",
                    "userIdentity": {"principalId": "AWS:AROAWTPYUEEUQM3LJFI6F:Mike_OCR_Map"},
                    "requestParameters": {"sourceIPAddress": "3.140.199.2"},
                    "responseElements": {
                        "x-amz-request-id": "01BDDA64A6566AB6",
                        "x-amz-id-2": "rn+rY2kH6sJb4VuIpiBqsaNb/pezRnzTGwekX2ZzEy5ydryeQV9tQd1xwFRBf88PFMvZXwR1DpJCmHrK2y6yBR4ETGTO/P35",
                    },
                    "s3": {
                        "s3SchemaVersion": "1.0",
                        "configurationId": "4cdd5e97-9790-4cb6-bb9c-fa4648ad18cf",
                        "bucket": {
                            "name": "textract-console-us-east-2-7e1edcda-ec50-4013-9762-a06e7b200006",
                            "ownerIdentity": {"principalId": "AFTBJ9N16F5MT"},
                            "arn": "arn:aws:s3:::textract-console-us-east-2-7e1edcda-ec50-4013-9762-a06e7b200006",
                        },
                        "object": {
                            "key": "ExtractorDeudas/Archivo/Forum/2021-01-20T22_00_52_875730/CAMILA_SEGUEL_-_CAV.pdf",
                            "size": 47395,
                            "eTag": "3cc458c4c5ba498b93005268ef061cac",
                            "sequencer": "006008A8174A4310A0",
                        },
                    },
                }
            ]
        },
        "responseContext": {"statusCode": 200, "executedVersion": "$LATEST"},
        "responsePayload": {
            "key": "ExtractorDeudas/Archivo/Forum/Test/CAMILA_SEGUEL_-_TABLA.pdf",
            "document_type": "tabla",
        },
    }

    expected_output = {
        "document_type": "tabla",
        "key": "ExtractorDeudas/Archivo/Forum/Test/CAMILA_SEGUEL_-_TABLA.pdf",
        "forms": {},
        "tables": [
            [
                [
                    "Cuota ",
                    "F .Veto. ",
                    "Factura ",
                    "Estado ",
                    "Fecha Pago ",
                    "Cuota ",
                    "Monto Actual ",
                    "Amortiz. ",
                    "Interes ",
                    "Capital ",
                ],
                [
                    "1 ",
                    "10-05-2018 ",
                    "",
                    "Pagado ",
                    "03-05-2018 ",
                    "301.072 ",
                    "7.839.317 ",
                    "95.264 ",
                    "205.808 ",
                    "7.744.053 ",
                ],
                [
                    "2 ",
                    "10-06-2018 ",
                    "",
                    "Pagado ",
                    "11-06-2018 ",
                    "301.072 ",
                    "7.744.053 ",
                    "157.833 ",
                    "143.239 ",
                    "7.586.221 ",
                ],
                [
                    "3 ",
                    "10-07-2018 ",
                    "",
                    "Pagado ",
                    "09-07-2018 ",
                    "301.072 ",
                    "7.586.221 ",
                    "165.278 ",
                    "135.793 ",
                    "7.420.942 ",
                ],
                [
                    "4 ",
                    "10-08-2018 ",
                    "",
                    "Pagado ",
                    "02-08-2018 ",
                    "301.072 ",
                    "7.420.942 ",
                    "163.809 ",
                    "137.263 ",
                    "7.257.133 ",
                ],
                [
                    "5 ",
                    "10-09-2018 ",
                    "",
                    "Pagado ",
                    "03-09-2018 ",
                    "301.072 ",
                    "7.257.133 ",
                    "166.839 ",
                    "134.233 ",
                    "7.090.294 ",
                ],
                [
                    "6 ",
                    "10-10-2018 ",
                    "",
                    "Pagado ",
                    "02-10-2018 ",
                    "301.072 ",
                    "7.090.294 ",
                    "174.156 ",
                    "126.916 ",
                    "6.916.138 ",
                ],
                [
                    "7 ",
                    "10-11-2018 ",
                    "",
                    "Pagado ",
                    "05-11-2018 ",
                    "301.072 ",
                    "6.916.138 ",
                    "173.146 ",
                    "127.926 ",
                    "6.742.992 ",
                ],
                [
                    "8 ",
                    "10-12-2018 ",
                    "",
                    "Pagado ",
                    "30-11-2018 ",
                    "301.072 ",
                    "6.742.992 ",
                    "180.372 ",
                    "120.700 ",
                    "6.562.620 ",
                ],
                [
                    "9 ",
                    "10-01-2019 ",
                    "",
                    "Pagado ",
                    "02-01-2019 ",
                    "301.072 ",
                    "6.562.620 ",
                    "179.685 ",
                    "121.387 ",
                    "6.382.935 ",
                ],
                [
                    "10 ",
                    "10-02-2019 ",
                    "",
                    "Pagado ",
                    "05-02-2019 ",
                    "301.072 ",
                    "6.382.935 ",
                    "183.009 ",
                    "118.063 ",
                    "6.199.926 ",
                ],
                [
                    "11 ",
                    "10-03-2019 ",
                    "",
                    "Pagado ",
                    "27-02-2019 ",
                    "301.072 ",
                    "6.199.926 ",
                    "197.492 ",
                    "103.580 ",
                    "6.002.434 ",
                ],
                [
                    "12 ",
                    "10-04-2019 ",
                    "",
                    "Pagado ",
                    "08-04-2019 ",
                    "301.072 ",
                    "6.002.434 ",
                    "190.047 ",
                    "111.025 ",
                    "5.812.387 ",
                ],
                [
                    "13 ",
                    "10-05-2019 ",
                    "",
                    "Pagado ",
                    "09-05-2019 ",
                    "301.072 ",
                    "5.812.387 ",
                    "197.030 ",
                    "104.042 ",
                    "5.615.357 ",
                ],
                [
                    "14 ",
                    "10-06-2019 ",
                    "",
                    "Pagado ",
                    "07-06-2019 ",
                    "301.072 ",
                    "5.615.357 ",
                    "197.206 ",
                    "103.865 ",
                    "5.418.151 ",
                ],
                [
                    "15 ",
                    "10-07-2019 ",
                    "",
                    "Pagado ",
                    "06-07-2019 ",
                    "301.072 ",
                    "5.418.151 ",
                    "204.087 ",
                    "96.985 ",
                    "5.214.064 ",
                ],
                [
                    "16 ",
                    "10-08-2019 ",
                    "",
                    "Pagado ",
                    "09-08-2019 ",
                    "301.072 ",
                    "5.214.064 ",
                    "204.629 ",
                    "96.443 ",
                    "5.009.435 ",
                ],
                [
                    "17 ",
                    "10-09-2019 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "5.009.435 ",
                    "208.414 ",
                    "92.658 ",
                    "4.801.021 ",
                ],
                [
                    "18 ",
                    "10-10-2019 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "4.801.021 ",
                    "215.134 ",
                    "85.938 ",
                    "4.585.887 ",
                ],
                [
                    "19 ",
                    "10-11-2019 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "4.585.887 ",
                    "216.248 ",
                    "84.824 ",
                    "4.369.639 ",
                ],
                [
                    "20 ",
                    "0-12-2019 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "4.369.639 ",
                    "222.855 ",
                    "78.217 ",
                    "4.146.784 ",
                ],
                [
                    "21 ",
                    "10-01-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "4.146.784 ",
                    "224.370 ",
                    "76.702 ",
                    "3.922.413 ",
                ],
                [
                    "22 ",
                    "10-02-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "3.922.413 ",
                    "228.520 ",
                    "72.552 ",
                    "3.693.893 ",
                ],
                [
                    "23 ",
                    "10-03-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "3.693.893 ",
                    "237.155 ",
                    "63.917 ",
                    "3.456.738 ",
                ],
                [
                    "24 ",
                    "10-04-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "3.456.738 ",
                    "237.134 ",
                    "63.938 ",
                    "3.219.604 ",
                ],
                [
                    "25 ",
                    "10-05-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "3.219.604 ",
                    "243.441 ",
                    "57.631 ",
                    "2.976.163 ",
                ],
                [
                    "26 ",
                    "10-06-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "2.976.163 ",
                    "246.023 ",
                    "55.049 ",
                    "2.730.141 ",
                ],
                [
                    "27 ",
                    "10-07-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "2.730.141 ",
                    "252.202 ",
                    "48.870 ",
                    "2.477.938 ",
                ],
                [
                    "28 ",
                    "10-08-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "2.477.938 ",
                    "255.238 ",
                    "45.834 ",
                    "2.222.700 ",
                ],
                [
                    "29 ",
                    "10-09-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "2.222.700 ",
                    "259.959 ",
                    "41.113 ",
                    "1.962.741 ",
                ],
                [
                    "30 ",
                    "10-10-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "1.962.741 ",
                    "265.939 ",
                    "35.133 ",
                    "1.696.802 ",
                ],
                [
                    "31 ",
                    "10-11-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "1.696.802 ",
                    "269.687 ",
                    "31.385 ",
                    "1.427.115 ",
                ],
                [
                    "32 ",
                    "10-12-2020 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "1.427.115 ",
                    "275.526 ",
                    "25.545 ",
                    "1.151.589 ",
                ],
                [
                    "33 ",
                    "10-01-2021 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "1.151.589 ",
                    "279.771 ",
                    "21.301 ",
                    "871.817 ",
                ],
                [
                    "34 ",
                    "10-02-2021 ",
                    "",
                    "No Pagado ",
                    "",
                    "301.072 ",
                    "871.817 ",
                    "284.946 ",
                    "16.126 ",
                    "586.871 ",
                ],
                ["35 ", "10-03-2021 ", "", "No Pagado ", "", "301.072 ", "586.871 ", "291.267 ", "9.805 ", "295.604 "],
                ["36 ", "10-04-2021 ", "", "No Pagado ", "", "301.072 ", "295.604 ", "295.604 ", "5.468 ", "0 "],
                ["", "", "", "", "", "T o T A L E ", "S : ", "7.839.317 ", "2.999.269 ", ""],
            ],
            [
                ["Bien: (1) AUDI Al, ", "SPORTBACK 1.4 TFSI MT, ", "año 2013 ", "(Usado) ", "", ""],
                ["Contrato: ", "LA852162 ", "Nombre: ", "CAMILA CONSTANZA SEGUEL ", "OLIVARES ", ""],
                ["Estado: ", "Activo ", "Tipo: ", "Crédito (c.c.) ", "R.U.T. : 17. 028. 624-3 ", ""],
                ["Fecha Curse: ", "29-03-2018 ", "Plazo: ", "36 (meses) ", "T .Cuota: Fija ", ""],
                ["Moneda: ", "Peso ", "T.Tasa: ", "Fija ", "Secu: ", ""],
                ["Clasif.cobranza: ", "", "F.Pagaré: ", "27-03-2018 ", "", ""],
                ["Monto del Bien: ", "9.890.000 ", "G .Legales: ", "182.600 ", "% Pie: ", "23,22 "],
                ["Monto Financiar: ", "7.839.317 ", "Im.Letras: ", "62.715 ", "Otros: ", "o "],
                ["Seguro Total: ", "O ", "Comisión: ", "529.196 ", "Rentas: ", "36 "],
                ["Gtos .Inscri. ", "65.000 ", "Op .Compra: ", "o ", "T .Pagaré ", "1,79 "],
                [". Cupón : ", "306.158 ", "IaRenta: ", "2.295.998 ", "Seg.Desg: ", "5.086 "],
                ["Pre-ev. Dealer: ", "529.196 ", "T.Cancel: ", "", "C.P. : ", "o "],
                ["SOAP : ", "o ", "F .Cancel: ", "", "Viaje Seguro: ", "o "],
                ["Garantía Mecánica: ", ". ", "Seg.ANF: ", "o ", "Seg.Trimax: ", "o "],
            ],
        ],
        "text": "FORüM Servicios Financieros Fecha: 23-01-2020 Hora: 9:05:32 DESARROLLO DE CONTRATOS Bien: (1) AUDI Al, SPORTBACK 1.4 TFSI MT, año 2013 (Usado) Contrato: LA852162 Nombre: CAMILA CONSTANZA SEGUEL OLIVARES Estado: Activo Tipo: Crédito (c.c.) R.U.T. : 17. 028. 624-3 Fecha Curse: 29-03-2018 Plazo: 36 (meses) T .Cuota: Fija Moneda: Peso T.Tasa: Fija Secu: Clasif.cobranza: F.Pagaré: 27-03-2018 Monto del Bien: 9.890.000 G .Legales: 182.600 % Pie: 23,22 Monto Financiar: 7.839.317 Im.Letras: 62.715 Otros: o Seguro Total: O Comisión: 529.196 Rentas: 36 Gtos .Inscri. 65.000 Op .Compra: o T .Pagaré 1,79 . Cupón : 306.158 IaRenta: 2.295.998 Seg.Desg: 5.086 Pre-ev. Dealer: 529.196 T.Cancel: C.P. : o SOAP : o F .Cancel: Viaje Seguro: o Garantía Mecánica: . Seg.ANF: o Seg.Trimax: o Dist : COMERCIAL AUTOMOTRIZ SIGLO XXI LIAEjec. : VERGARA KEMP YENNIFER Valor Saldo Cuota F .Veto. Factura Estado Fecha Pago Cuota Monto Actual Amortiz. Interes Capital 1 10-05-2018 Pagado 03-05-2018 301.072 7.839.317 95.264 205.808 7.744.053 2 10-06-2018 Pagado 11-06-2018 301.072 7.744.053 157.833 143.239 7.586.221 3 10-07-2018 Pagado 09-07-2018 301.072 7.586.221 165.278 135.793 7.420.942 4 10-08-2018 Pagado 02-08-2018 301.072 7.420.942 163.809 137.263 7.257.133 5 10-09-2018 Pagado 03-09-2018 301.072 7.257.133 166.839 134.233 7.090.294 6 10-10-2018 Pagado 02-10-2018 301.072 7.090.294 174.156 126.916 6.916.138 7 10-11-2018 Pagado 05-11-2018 301.072 6.916.138 173.146 127.926 6.742.992 8 10-12-2018 Pagado 30-11-2018 301.072 6.742.992 180.372 120.700 6.562.620 9 10-01-2019 Pagado 02-01-2019 301.072 6.562.620 179.685 121.387 6.382.935 10 10-02-2019 Pagado 05-02-2019 301.072 6.382.935 183.009 118.063 6.199.926 11 10-03-2019 Pagado 27-02-2019 301.072 6.199.926 197.492 103.580 6.002.434 12 10-04-2019 Pagado 08-04-2019 301.072 6.002.434 190.047 111.025 5.812.387 13 10-05-2019 Pagado 09-05-2019 301.072 5.812.387 197.030 104.042 5.615.357 14 10-06-2019 Pagado 07-06-2019 301.072 5.615.357 197.206 103.865 5.418.151 15 10-07-2019 Pagado 06-07-2019 301.072 5.418.151 204.087 96.985 5.214.064 16 10-08-2019 Pagado 09-08-2019 301.072 5.214.064 204.629 96.443 5.009.435 17 10-09-2019 No Pagado 301.072 5.009.435 208.414 92.658 4.801.021 18 10-10-2019 No Pagado 301.072 4.801.021 215.134 85.938 4.585.887 19 10-11-2019 No Pagado 301.072 4.585.887 216.248 84.824 4.369.639 20 0-12-2019 No Pagado 301.072 4.369.639 222.855 78.217 4.146.784 21 10-01-2020 No Pagado 301.072 4.146.784 224.370 76.702 3.922.413 22 10-02-2020 No Pagado 301.072 3.922.413 228.520 72.552 3.693.893 23 10-03-2020 No Pagado 301.072 3.693.893 237.155 63.917 3.456.738 24 10-04-2020 No Pagado 301.072 3.456.738 237.134 63.938 3.219.604 25 10-05-2020 No Pagado 301.072 3.219.604 243.441 57.631 2.976.163 26 10-06-2020 No Pagado 301.072 2.976.163 246.023 55.049 2.730.141 27 10-07-2020 No Pagado 301.072 2.730.141 252.202 48.870 2.477.938 28 10-08-2020 No Pagado 301.072 2.477.938 255.238 45.834 2.222.700 29 10-09-2020 No Pagado 301.072 2.222.700 259.959 41.113 1.962.741 30 10-10-2020 No Pagado 301.072 1.962.741 265.939 35.133 1.696.802 31 10-11-2020 No Pagado 301.072 1.696.802 269.687 31.385 1.427.115 32 10-12-2020 No Pagado 301.072 1.427.115 275.526 25.545 1.151.589 33 10-01-2021 No Pagado 301.072 1.151.589 279.771 21.301 871.817 34 10-02-2021 No Pagado 301.072 871.817 284.946 16.126 586.871 35 10-03-2021 No Pagado 301.072 586.871 291.267 9.805 295.604 36 10-04-2021 No Pagado 301.072 295.604 295.604 5.468 0 T o T A L E S : 7.839.317 2.999.269 ",
    }
    results = lambda_handler(event, "")
    assert results == expected_output


if __name__ == "__main__":
    text_textract_with_cav()
    text_textract_with_pagare()
    text_textract_with_tabla()
    print("\033[92mAll test OK\033[0m")
